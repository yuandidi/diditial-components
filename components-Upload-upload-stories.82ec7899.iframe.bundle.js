"use strict";(self.webpackChunkdiditial=self.webpackChunkdiditial||[]).push([[727],{"./src/components/Upload/upload.stories.tsx":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{DefaultUpload:()=>DefaultUpload,__namedExportsOrder:()=>__namedExportsOrder,default:()=>upload_stories});var react=__webpack_require__("./node_modules/react/index.js"),icon=__webpack_require__("./src/components/Icon/icon.tsx"),jsx_runtime=__webpack_require__("./node_modules/react/jsx-runtime.js");const Progress_progress=_ref=>{let{percent,strokeHeight=15,showText=!0,styles,theme="primary"}=_ref;return(0,jsx_runtime.jsx)("div",{className:"didi-progress-bar",style:styles,children:(0,jsx_runtime.jsx)("div",{className:"didi-progress-bar-outer",style:{height:`${strokeHeight}px`},children:(0,jsx_runtime.jsx)("div",{className:`didi-progress-bar-inner color-${theme}`,style:{width:`${percent}%`},children:showText&&(0,jsx_runtime.jsx)("span",{className:"inner-text",children:`${percent}%`})})})})};try{progress.displayName="progress",progress.__docgenInfo={description:"",displayName:"progress",props:{percent:{defaultValue:null,description:"",name:"percent",required:!0,type:{name:"number"}},strokeHeight:{defaultValue:{value:"15"},description:"",name:"strokeHeight",required:!1,type:{name:"number"}},showText:{defaultValue:{value:"true"},description:"",name:"showText",required:!1,type:{name:"boolean"}},styles:{defaultValue:null,description:"",name:"styles",required:!1,type:{name:"CSSProperties"}},theme:{defaultValue:{value:"primary"},description:"",name:"theme",required:!1,type:{name:"enum",value:[{value:'"info"'},{value:'"warning"'},{value:'"success"'},{value:'"danger"'},{value:'"primary"'},{value:'"secondary"'},{value:'"light"'},{value:'"dark"'}]}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/components/Progress/progress.tsx#progress"]={docgenInfo:progress.__docgenInfo,name:"progress",path:"src/components/Progress/progress.tsx#progress"})}catch(__react_docgen_typescript_loader_error){}const UploadList=_ref=>{let{fileList,onRemove}=_ref;return(0,jsx_runtime.jsx)("ul",{className:"didi-upload-list",children:fileList.map((item=>(0,jsx_runtime.jsxs)("li",{className:"didi-upload-list-item",children:[(0,jsx_runtime.jsxs)("span",{"data-testid":`file-name-${item.status}`,className:`file-name file-name-${item.status}`,children:[(0,jsx_runtime.jsx)(icon.A,{icon:"file-alt",theme:"secondary"}),item.name]}),(0,jsx_runtime.jsxs)("span",{className:"file-status",children:[("uploading"===item.status||"ready"===item.status)&&(0,jsx_runtime.jsx)(icon.A,{icon:"spinner",spin:!0,theme:"primary"}),"success"===item.status&&(0,jsx_runtime.jsx)(icon.A,{icon:"check-circle",theme:"success"}),"error"===item.status&&(0,jsx_runtime.jsx)(icon.A,{icon:"times-circle",theme:"danger"})]}),(0,jsx_runtime.jsx)("span",{className:"file-action",children:(0,jsx_runtime.jsx)(icon.A,{icon:"times",onClick:()=>{onRemove(item)}})}),"uploading"===item.status&&(0,jsx_runtime.jsx)(Progress_progress,{percent:item.percent||0})]},item.uid)))})},Upload_uploadList=UploadList;try{UploadList.displayName="UploadList",UploadList.__docgenInfo={description:"",displayName:"UploadList",props:{fileList:{defaultValue:null,description:"",name:"fileList",required:!0,type:{name:"UploadFile[]"}},onRemove:{defaultValue:null,description:"",name:"onRemove",required:!0,type:{name:"(_file: UploadFile) => void"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/components/Upload/uploadList.tsx#UploadList"]={docgenInfo:UploadList.__docgenInfo,name:"UploadList",path:"src/components/Upload/uploadList.tsx#UploadList"})}catch(__react_docgen_typescript_loader_error){}try{uploadList.displayName="uploadList",uploadList.__docgenInfo={description:"",displayName:"uploadList",props:{fileList:{defaultValue:null,description:"",name:"fileList",required:!0,type:{name:"UploadFile[]"}},onRemove:{defaultValue:null,description:"",name:"onRemove",required:!0,type:{name:"(_file: UploadFile) => void"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/components/Upload/uploadList.tsx#uploadList"]={docgenInfo:uploadList.__docgenInfo,name:"uploadList",path:"src/components/Upload/uploadList.tsx#uploadList"})}catch(__react_docgen_typescript_loader_error){}var axios=__webpack_require__("./node_modules/axios/index.js"),axios_default=__webpack_require__.n(axios),classnames=__webpack_require__("./node_modules/classnames/index.js"),classnames_default=__webpack_require__.n(classnames);const Dragger=_ref=>{let{onFile,children}=_ref;const[dragOver,setDragOver]=(0,react.useState)(!1),klass=classnames_default()("didi-uploader-dragger",{"is-dragover":dragOver}),handleDrag=(e,over)=>{e.preventDefault(),setDragOver(over)};return(0,jsx_runtime.jsx)("div",{className:klass,onDragOver:e=>{handleDrag(e,!0)},onDragLeave:e=>{handleDrag(e,!1)},onDrop:e=>{e.preventDefault(),setDragOver(!1),onFile&&onFile(e.dataTransfer.files)},children})},Upload_dragger=Dragger;try{Dragger.displayName="Dragger",Dragger.__docgenInfo={description:"",displayName:"Dragger",props:{onFile:{defaultValue:null,description:"",name:"onFile",required:!1,type:{name:"((files: FileList) => void)"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/components/Upload/dragger.tsx#Dragger"]={docgenInfo:Dragger.__docgenInfo,name:"Dragger",path:"src/components/Upload/dragger.tsx#Dragger"})}catch(__react_docgen_typescript_loader_error){}try{dragger.displayName="dragger",dragger.__docgenInfo={description:"",displayName:"dragger",props:{onFile:{defaultValue:null,description:"",name:"onFile",required:!1,type:{name:"((files: FileList) => void)"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/components/Upload/dragger.tsx#dragger"]={docgenInfo:dragger.__docgenInfo,name:"dragger",path:"src/components/Upload/dragger.tsx#dragger"})}catch(__react_docgen_typescript_loader_error){}const Upload=_ref=>{let{action,defaultFileList,onChange,beforeUpload,onProgress,onSuccess,onError,onRemove,headers,name="file",data,withCredentials,accept,multiple,children,drag}=_ref;const fileInput=(0,react.useRef)(null),[fileList,setFileList]=(0,react.useState)(defaultFileList||[]),updateFileList=(updateFile,updateObj)=>{setFileList((preList=>preList.map((file=>file.uid===updateFile.uid?{...file,...updateObj}:file))))},uploadFiles=files=>{Array.from(files).forEach((file=>{if(beforeUpload){const result=beforeUpload(file);result&&result instanceof Promise?result.then((processedFile=>{post(processedFile)})):!1!==result&&post(file)}else post(file)}))},post=file=>{let _file={uid:Date.now()+"upload-file",name:file.name,size:file.size,percent:0,raw:file};setFileList((preList=>[_file,...preList]));const formData=new FormData;formData.append(name||"file",file),data&&Object.keys(data).forEach((key=>{formData.append(key,data[key])})),axios_default().post(action,formData,{headers:{...headers,"Content-Type":"multipart/form-data"},withCredentials,onUploadProgress:e=>{let percentage=e.total&&Math.round(100*e.loaded/e.total)||0;percentage<100&&(updateFileList(_file,{percent:percentage,status:"uploading"}),onProgress&&onProgress(percentage,_file))}}).then((res=>{updateFileList(_file,{status:"success",response:res.data}),onSuccess&&onSuccess(res.data,_file),onChange&&onChange(_file)})).catch((error=>{console.error(error),updateFileList(_file,{status:"error",error}),onError&&onError(error,_file),onChange&&onChange(_file)}))};return(0,jsx_runtime.jsxs)("div",{className:"didi-upload-component",children:[(0,jsx_runtime.jsx)("div",{className:"didi-upload-input",style:{display:"inline-block"},onClick:()=>{fileInput.current&&fileInput.current.click()},children:drag?(0,jsx_runtime.jsx)(Upload_dragger,{onFile:files=>{uploadFiles(files)},children}):children}),(0,jsx_runtime.jsx)("input",{className:"didi-file-input","data-testid":"didi-file-input",style:{display:"none"},type:"file",ref:fileInput,onChange:e=>{const files=e.target.files;files&&(uploadFiles(files),fileInput.current&&(fileInput.current.value=""))},accept,multiple}),(0,jsx_runtime.jsx)(Upload_uploadList,{fileList,onRemove:file=>{setFileList((preList=>preList.filter((item=>item.uid!==file.uid)))),onRemove&&onRemove(file)}})]})},Upload_upload=Upload;try{Upload.displayName="Upload",Upload.__docgenInfo={description:"通过点击或者拖拽上传文件\n### 引用方法\n\n~~~js\nimport { Upload } from 'didiship'\n~~~",displayName:"Upload",props:{action:{defaultValue:null,description:"必选参数, 上传的地址",name:"action",required:!0,type:{name:"string"}},defaultFileList:{defaultValue:null,description:"上传的文件列表,",name:"defaultFileList",required:!1,type:{name:"UploadFile[]"}},beforeUpload:{defaultValue:null,description:"上传文件之前的钩子，参数为上传的文件，若返回 false 或者 Promise 则停止上传。",name:"beforeUpload",required:!1,type:{name:"((file: File) => boolean | Promise<File>)"}},onProgress:{defaultValue:null,description:"文件上传时的钩子",name:"onProgress",required:!1,type:{name:"((percentage: number, file: UploadFile) => void)"}},onSuccess:{defaultValue:null,description:"文件上传成功时的钩子",name:"onSuccess",required:!1,type:{name:"((data: any, file: UploadFile) => void)"}},onError:{defaultValue:null,description:"文件上传失败时的钩子",name:"onError",required:!1,type:{name:"((err: any, file: UploadFile) => void)"}},onChange:{defaultValue:null,description:"文件状态改变时的钩子，上传成功或者失败时都会被调用",name:"onChange",required:!1,type:{name:"((file: UploadFile) => void)"}},onRemove:{defaultValue:null,description:"文件列表移除文件时的钩子",name:"onRemove",required:!1,type:{name:"((file: UploadFile) => void)"}},headers:{defaultValue:null,description:"设置上传的请求头部",name:"headers",required:!1,type:{name:"{ [key: string]: any; }"}},name:{defaultValue:{value:"file"},description:"上传的文件字段名",name:"name",required:!1,type:{name:"string"}},data:{defaultValue:null,description:"上传时附带的额外参数",name:"data",required:!1,type:{name:"{ [key: string]: any; }"}},withCredentials:{defaultValue:null,description:"支持发送 cookie 凭证信息",name:"withCredentials",required:!1,type:{name:"boolean"}},accept:{defaultValue:null,description:"可选参数, 接受上传的文件类型",name:"accept",required:!1,type:{name:"string"}},multiple:{defaultValue:null,description:"是否支持多选文件",name:"multiple",required:!1,type:{name:"boolean"}},drag:{defaultValue:null,description:"是否支持拖拽上传",name:"drag",required:!1,type:{name:"boolean"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/components/Upload/upload.tsx#Upload"]={docgenInfo:Upload.__docgenInfo,name:"Upload",path:"src/components/Upload/upload.tsx#Upload"})}catch(__react_docgen_typescript_loader_error){}try{upload.displayName="upload",upload.__docgenInfo={description:"通过点击或者拖拽上传文件\n### 引用方法\n\n~~~js\nimport { Upload } from 'didiship'\n~~~",displayName:"upload",props:{action:{defaultValue:null,description:"必选参数, 上传的地址",name:"action",required:!0,type:{name:"string"}},defaultFileList:{defaultValue:null,description:"上传的文件列表,",name:"defaultFileList",required:!1,type:{name:"UploadFile[]"}},beforeUpload:{defaultValue:null,description:"上传文件之前的钩子，参数为上传的文件，若返回 false 或者 Promise 则停止上传。",name:"beforeUpload",required:!1,type:{name:"((file: File) => boolean | Promise<File>)"}},onProgress:{defaultValue:null,description:"文件上传时的钩子",name:"onProgress",required:!1,type:{name:"((percentage: number, file: UploadFile) => void)"}},onSuccess:{defaultValue:null,description:"文件上传成功时的钩子",name:"onSuccess",required:!1,type:{name:"((data: any, file: UploadFile) => void)"}},onError:{defaultValue:null,description:"文件上传失败时的钩子",name:"onError",required:!1,type:{name:"((err: any, file: UploadFile) => void)"}},onChange:{defaultValue:null,description:"文件状态改变时的钩子，上传成功或者失败时都会被调用",name:"onChange",required:!1,type:{name:"((file: UploadFile) => void)"}},onRemove:{defaultValue:null,description:"文件列表移除文件时的钩子",name:"onRemove",required:!1,type:{name:"((file: UploadFile) => void)"}},headers:{defaultValue:null,description:"设置上传的请求头部",name:"headers",required:!1,type:{name:"{ [key: string]: any; }"}},name:{defaultValue:{value:"file"},description:"上传的文件字段名",name:"name",required:!1,type:{name:"string"}},data:{defaultValue:null,description:"上传时附带的额外参数",name:"data",required:!1,type:{name:"{ [key: string]: any; }"}},withCredentials:{defaultValue:null,description:"支持发送 cookie 凭证信息",name:"withCredentials",required:!1,type:{name:"boolean"}},accept:{defaultValue:null,description:"可选参数, 接受上传的文件类型",name:"accept",required:!1,type:{name:"string"}},multiple:{defaultValue:null,description:"是否支持多选文件",name:"multiple",required:!1,type:{name:"boolean"}},drag:{defaultValue:null,description:"是否支持拖拽上传",name:"drag",required:!1,type:{name:"boolean"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/components/Upload/upload.tsx#upload"]={docgenInfo:upload.__docgenInfo,name:"upload",path:"src/components/Upload/upload.tsx#upload"})}catch(__react_docgen_typescript_loader_error){}const upload_stories={component:Upload_upload,title:"Upload",tags:["autodocs"]},DefaultUpload={name:"默认Upload",args:{action:"https://jsonplaceholder.typicode.com/posts/",onChange:file=>{console.log("changed")},onSuccess:(res,file)=>{console.log("success",res,file)},defaultFileList:[{uid:"123 ",size:1234,name:"hello.md",status:"uploading",percent:30},{uid:"122 ",size:1234,name:"world.md",status:"success",percent:30},{uid:"121 ",size:1234,name:"haha.md",status:"error",percent:30}],name:"fileName",data:{key:"value"},headers:{"X-Powered-By":"axios"},multiple:!0,drag:!0},render:args=>(0,jsx_runtime.jsxs)(Upload_upload,{...args,children:[(0,jsx_runtime.jsx)(icon.A,{icon:"upload",size:"5x",theme:"secondary"}),(0,jsx_runtime.jsx)("br",{}),(0,jsx_runtime.jsx)("p",{children:"Drag file over to upload"})]})},__namedExportsOrder=["DefaultUpload"];DefaultUpload.parameters={...DefaultUpload.parameters,docs:{...DefaultUpload.parameters?.docs,source:{originalSource:"{\n  name: '默认Upload',\n  args: {\n    action: \"https://jsonplaceholder.typicode.com/posts/\",\n    onChange: file => {\n      console.log('changed');\n    },\n    onSuccess: (res, file) => {\n      console.log('success', res, file);\n    },\n    defaultFileList: defaultFileList,\n    name: 'fileName',\n    data: {\n      'key': 'value'\n    },\n    headers: {\n      'X-Powered-By': 'axios'\n    },\n    multiple: true,\n    drag: true\n  },\n  render: args => <Upload {...args}>\r\n      <Icon icon=\"upload\" size='5x' theme=\"secondary\" />\r\n      <br />\r\n      <p>Drag file over to upload</p>\r\n    </Upload>\n}",...DefaultUpload.parameters?.docs?.source}}}},"./src/components/Icon/icon.tsx":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{A:()=>__WEBPACK_DEFAULT_EXPORT__});__webpack_require__("./node_modules/react/index.js");var _fortawesome_react_fontawesome__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./node_modules/@fortawesome/react-fontawesome/index.es.js"),classnames__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./node_modules/classnames/index.js"),classnames__WEBPACK_IMPORTED_MODULE_2___default=__webpack_require__.n(classnames__WEBPACK_IMPORTED_MODULE_2__),react_jsx_runtime__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("./node_modules/react/jsx-runtime.js");const __WEBPACK_DEFAULT_EXPORT__=props=>{const{className,theme,...restProps}=props,classes=classnames__WEBPACK_IMPORTED_MODULE_2___default()("didi-icon",className,{[`icon-${theme}`]:theme});return(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_3__.jsx)(_fortawesome_react_fontawesome__WEBPACK_IMPORTED_MODULE_1__.g,{className:classes,...restProps})};try{icon.displayName="icon",icon.__docgenInfo={description:"",displayName:"icon",props:{theme:{defaultValue:null,description:"",name:"theme",required:!1,type:{name:"enum",value:[{value:'"info"'},{value:'"warning"'},{value:'"success"'},{value:'"danger"'},{value:'"primary"'},{value:'"secondary"'},{value:'"light"'},{value:'"dark"'}]}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/components/Icon/icon.tsx#icon"]={docgenInfo:icon.__docgenInfo,name:"icon",path:"src/components/Icon/icon.tsx#icon"})}catch(__react_docgen_typescript_loader_error){}}}]);